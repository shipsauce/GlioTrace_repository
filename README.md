# GlioTrace: AI-Driven Glioblastoma Invasion Mapping in Live Brain Slices
GlioTrace is a novel ex vivo imaging and AI-based analytical framework that enables real-time, spatiotemporal tracking of cell migration dynamics in patient-derived glioma cell culture xenograft (PDCX) brain slices. The computational framework, written in MATLAB and made available in this repository, enables tracking and classification of migrating cells in real time, preceded by video registration, stabilization and region selection. From the extensive data collection generated by the cell tracking and classifcation, the framework generates statistics on cell migration and cell phenotypic changes over time and in response to therapy.

## Whole-specimen imaging of PDCX brain slices
Brain slices are kept alive and imaged for up to six days, enabling long-term observations of cell invasion dynamics.
<p align="left">
  <img src="README_material/BS6_3013_mouse2zoom_A02.gif" width="52%" />
</p>

## Multi-object tracking coupled to changes in cell morphology
GlioTrace captures invasion dynamics of individual cells and registers cell morphology at each time step.
Here, colors represent the different morphologies assigned by a convolutional neural network.

<p align="left">
  <img src="README_material/set_35_exp_162_roi_7.gif" width="45%" />
  <span style="display:inline-block; width:10%;"></span>
  <img src="README_material/3dplot.gif" width="54.3%" />
</p>

## GlioTrace framework overview

Preprocessing and analysis of image data happens in a discrete set of steps using the functions provided in this repo.


![Flowchart of framework](codebase_flowchart.svg)



## Running the framework

To run GlioTrace, clone this repository into your local MATLAB environment

```bash
# Clone the repository
!git clone https://github.com/shipsauce/brainslice_manuscript_repo.git
!cd Gliotrace_framework
```

## Demo code to get you started
```matlab 
% Define paths to image stacks
stackfile = 'stacks.txt';

% Define output path for generated videos (optional, otherwise run gliotrace without specifying path)
output_path = '../output/';

% Run GlioTrace on stacks
gliotrace_output = gliotrace(stackfile, output_path);

% Plot the relative proportions of cells in different classes for each celline
perturbation = {"control","thapsigargin"};
style = "mean";
plot_proportions(gliotrace_output.slice_statistics,style,perturbation)

% Plot the speed + TAD of cells in different morphological classes for one celline
celline = "U3013MG";
perturbation = "control";
dose = 0;
plot_cell_statistics(gliotrace_output.cell_statistics, celline, perturbation, dose)

% Plot heatmap of dose_dependent drug effects
perturbation = "dasatinib";
plot_drug_effects(gliotrace_output.drug_statistics, perturbation)

```


## Contact

For questions, contact madeleine.skeppas@igp.uu.se !
